<!--pages/addRecord/addRecord.wxml-->
<view class="container">
  <!-- å® ç‰©ä¿¡æ¯ -->
  <view class="pet-info-wrapper">
    <view class="pet-info" wx:if="{{petInfo}}">
      <view class="pet-info-header">
        <view class="pet-avatar">
          <text class="pet-emoji">ğŸˆ</text>
        </view>
        <view class="pet-details">
          <view class="pet-name">{{petInfo.name}}</view>
          <view class="pet-breed">{{petInfo.breed || 'æœªçŸ¥å“ç§'}}</view>
        </view>
        <view class="pet-status {{petInfo.status === 'ä½é™¢' ? 'status-hospitalized' : 'status-postop'}}">
          {{petInfo.status || 'æœ¯å'}}
        </view>
      </view>
    </view>
  </view>
  
  <!-- è®°å½•è¡¨å• -->
  <view class="form-wrapper">
    <view class="record-form">
      <view class="form-title">æ·»åŠ çŠ¶æ€è®°å½•</view>
      <view class="form-item">
        <textarea class="content-textarea" 
                  placeholder="è¯·è¾“å…¥å® ç‰©çŠ¶æ€è®°å½•å†…å®¹..." 
                  bindinput="inputContent"
                  value="{{newRecord.content}}"
                  maxlength="500"
                  focus="true"></textarea>
        <view class="textarea-counter {{newRecord.content.length > 450 ? 'counter-warning' : ''}}">{{newRecord.content.length}}/500</view>
      </view>
    
      <!-- å›¾ç‰‡ä¸Šä¼  -->
      <view class="form-item">
        <view class="upload-title">
          <text>æ·»åŠ å›¾ç‰‡</text>
          <text class="upload-count">{{newRecord.images.length}}/9</text>
        </view>
        <view class="image-list">
          <!-- å·²ä¸Šä¼ å›¾ç‰‡ -->
          <view class="image-item" wx:for="{{newRecord.images}}" wx:key="index">
            <image src="{{item}}" mode="aspectFill" bindtap="previewImage" data-src="{{item}}" show-menu-by-longpress></image>
            <view class="delete-btn" bindtap="deleteImage" data-index="{{index}}">
              <text class="delete-icon">Ã—</text>
            </view>
          </view>
          
          <!-- æ·»åŠ å›¾ç‰‡æŒ‰é’® -->
          <view class="image-item add-image" bindtap="chooseImage" wx:if="{{newRecord.images.length < 9}}">
            <view class="add-icon">
              <text class="add-icon-plus">+</text>
              <text class="add-icon-text">ç…§ç‰‡</text>
            </view>
          </view>
        </view>
      </view>
    </view>
  </view>
  
  <!-- æäº¤æŒ‰é’® -->
  <view class="actions-wrapper">
    <view class="form-actions">
      <button class="btn-cancel" bindtap="navigateBack" hover-class="btn-hover">
        <text class="btn-icon">â†</text>
        <text>å–æ¶ˆ</text>
      </button>
      <button class="btn-submit" bindtap="submitRecord" loading="{{loading}}" hover-class="btn-hover">
        <text class="btn-icon">âœ“</text>
        <text>æäº¤</text>
      </button>
    </view>
  </view>
  
  <!-- åŠ è½½ä¸­é®ç½© -->
  <view class="loading-mask" wx:if="{{loading}}">
    <view class="loading-content">
      <view class="loading-spinner"></view>
      <view class="loading-text">æ­£åœ¨ä¿å­˜...</view>
    </view>
  </view>
</view>
