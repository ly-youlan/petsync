<!--pages/workbench/workbench.wxml-->
<view class="container">
  <!-- å·²å®¡æ ¸é€šè¿‡çš„å·¥ä½œå° -->
  <block wx:if="{{isApproved}}">
    <view class="header-container">
      <view class="hospital-info">
        <view class="custom-icon info-icon">
          <text>i</text>
        </view>
        <view class="hospital-text">
          <view class="hospital-name">{{clinicInfo.name || 'å® ç‰©è¯Šæ‰€'}}</view>
          <view class="vet-name">å…½åŒ»å¸ˆï¼š{{userInfo.vetName}}</view>
        </view>
      </view>
      <view class="settings-btn" bindtap="goToSettings">
        <view class="custom-icon setting-icon">
          <text>âš™</text>
        </view>
        <text>è®¾ç½®</text>
      </view>
    </view>
    
    <view class="header">
      <view class="search-box">
        <input type="text" placeholder="æœç´¢å® ç‰©åç§°/ä¸»äººæ‰‹æœºå·" bindinput="search" />
        <view class="search-icon">
          <view class="custom-icon search-icon">
            <text>ğŸ”</text>
          </view>
        </view>
      </view>
      
      <view class="filters">
        <view wx:for="{{filters}}" wx:key="index" 
              class="filter {{selectedFilters.includes(item) ? 'active' : ''}}"
              bindtap="toggleFilter" data-filter="{{item}}">
          <text>{{item}}</text>
        </view>
        <view class="filter add-filter" bindtap="showAddFilterModal">
          <text>+</text>
        </view>
      </view>
    </view>
    
    <!-- åˆ›å»ºæ–°å® ç‰©è®°å½•æŒ‰é’® -->
    <view class="create-btn" bindtap="goToCreatePetRecord">
      <view class="custom-icon add-icon">
        <text>+</text>
      </view>
      <text>åˆ›å»ºæ–°å® ç‰©è®°å½•</text>
    </view>
    
    <!-- å® ç‰©è®°å½•åˆ—è¡¨ -->
    <view class="pet-records" wx:if="{{!loading && petRecords.length > 0}}">
      <view class="pet-card" wx:for="{{petRecords}}" wx:key="_id" bindtap="goToPetDetail" data-id="{{item._id}}">
        <view class="pet-image">
          <block wx:if="{{item.petInfo.avatar}}">
            <image src="{{item.petInfo.avatar}}" mode="aspectFill"></image>
          </block>
          <block wx:else>
            <view class="default-pet-icon">
              <view class="custom-icon pet-icon">
                <text>ğŸˆ</text>
              </view>
            </view>
          </block>
        </view>
        <view class="pet-info">
          <view>
            <view class="pet-name-row">
              <view class="pet-name">{{item.petInfo.name}}</view>
              <view class="pet-time">
                <text>{{item.createTime}}</text>
              </view>
            </view>
            
            <view class="pet-tags">
              <view wx:for="{{item.tags}}" wx:for-item="tag" wx:key="index"
                    class="pet-tag {{tag === 'åœ¨é™¢' ? 'tag-hospitalized' : (tag === 'å‡ºé™¢' ? 'tag-postop' : 'tag-other')}}">
                <text>{{tag}}</text>
              </view>
            </view>
            
            <view class="pet-breed">{{item.petInfo.breed || 'æœªçŸ¥å“ç§'}}</view>
          </view>
          
          <view class="pet-owner">
            <view class="owner-label">ä¸»äºº</view>
            <view class="owner-phone">{{item.ownerInfo.phoneNumber || 'æœªçŸ¥'}}</view>
          </view>
        </view>
        
        <view class="arrow">
          <view class="custom-icon more-icon">
            <text>></text>
          </view>
        </view>
      </view>
    </view>
    
    <!-- ç©ºçŠ¶æ€ -->
    <view class="empty-state" wx:if="{{!loading && petRecords.length === 0}}">
      <view class="empty-icon">
        <view class="custom-icon warn-icon">
          <text>!</text>
        </view>
      </view>
      <view class="empty-text">æš‚æ— å® ç‰©è®°å½•</view>
      <view class="empty-subtext">ç‚¹å‡»ä¸Šæ–¹æŒ‰é’®åˆ›å»ºæ–°çš„å® ç‰©è®°å½•</view>
      <view class="empty-action" bindtap="goToCreatePetRecord">
        <text>ç«‹å³åˆ›å»º</text>
      </view>
    </view>
  </block>
  
  <!-- å·²åˆ é™¤å¾…å®¡æ ¸çŠ¶æ€åŒºå—ï¼Œå·²åœ¨ç™»å½•é¡µé¢å¤„ç†å®¡æ ¸çŠ¶æ€ -->
  
  <!-- åŠ è½½ä¸­ -->
  <view class="loading" wx:if="{{loading}}">
    <view class="loading-icon"></view>
    <view class="loading-text">åŠ è½½ä¸­...</view>
  </view>
</view>
