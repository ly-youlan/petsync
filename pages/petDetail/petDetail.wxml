<!--pages/petDetail/petDetail.wxml-->
<view class="container">
  <!-- 加载中 -->
  <view class="loading" wx:if="{{loading}}">
    <view class="loading-icon"></view>
    <view class="loading-text">加载中...</view>
  </view>
  
  <!-- 宠物信息 -->
  <view class="pet-header" wx:if="{{!loading && pet}}">
    <view class="pet-avatar">
      <image src="{{pet.avatar || '/images/default-pet.png'}}" mode="aspectFill"></image>
    </view>
    <view class="pet-info">
      <view class="pet-name">{{pet.name}}</view>
      <view class="pet-breed">品种：{{pet.breed}}</view>
      <view class="pet-status {{pet.status === '住院' ? 'status-hospitalized' : 'status-postop'}}">
        {{pet.status}}
      </view>
      <view class="pet-reason">入院原因：{{pet.reason}}</view>
      <view class="pet-time">创建时间：{{pet.createTime}}</view>
    </view>
  </view>
  
  <!-- 主人信息 -->
  <view class="owner-info" wx:if="{{!loading && pet && pet.ownerInfo}}">
    <view class="section-title">主人信息</view>
    <view class="owner-content">
      <view class="owner-item">
        <text class="item-label">手机号：</text>
        <text class="item-value">{{pet.ownerInfo.phoneNumber}}</text>
      </view>
      <view class="owner-item" wx:if="{{pet.ownerInfo.name}}">
        <text class="item-label">姓名：</text>
        <text class="item-value">{{pet.ownerInfo.name}}</text>
      </view>
    </view>
  </view>
  
  <!-- 操作按钮 -->
  <view class="action-buttons" wx:if="{{!loading && pet}}">
    <button class="btn-add" bindtap="addNewRecord">
      <image src="/images/add-icon.png" mode="aspectFit"></image>
      添加新记录
    </button>
    <button class="btn-share" bindtap="sharePetRecord">
      <image src="/images/share-icon.png" mode="aspectFit"></image>
      分享给主人
    </button>
  </view>
  
  <!-- 记录列表 -->
  <view class="section-title" wx:if="{{!loading && records.length > 0}}">状态记录</view>
  <view class="record-list" wx:if="{{!loading && records.length > 0}}">
    <view wx:for="{{records}}" wx:key="id" class="record-item">
      <view class="record-header">
        <text class="record-time">{{item.createdAt}}</text>
        <view class="record-actions">
          <button class="btn-icon" bindtap="editRecord" data-id="{{item.id}}">
            <image src="/images/edit-icon.png" mode="aspectFit"></image>
          </button>
          <button class="btn-icon" bindtap="deleteRecord" data-id="{{item.id}}">
            <image src="/images/delete-icon.png" mode="aspectFit"></image>
          </button>
        </view>
      </view>
      <view class="record-content">
        <text>{{item.content}}</text>
      </view>
      <view class="record-images" wx:if="{{item.images && item.images.length > 0}}">
        <image wx:for="{{item.images}}" wx:for-item="img" wx:key="index" 
               src="{{img}}" mode="aspectFill" class="record-image"
               bindtap="previewImage" data-src="{{img}}" data-urls="{{item.images}}"></image>
      </view>
    </view>
  </view>
  
  <!-- 空状态 -->
  <view class="empty-state" wx:if="{{!loading && records.length === 0}}">
    <image src="/images/empty-state.png" mode="aspectFit"></image>
    <view class="empty-text">暂无状态记录</view>
    <view class="empty-subtext">点击上方按钮添加新的状态记录</view>
  </view>
</view>
