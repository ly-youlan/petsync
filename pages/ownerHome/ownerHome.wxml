<!--pages/ownerHome/ownerHome.wxml-->
<view class="container">
  <!-- å¤´éƒ¨åŒºåŸŸ -->
  <view class="header">
    <view class="user-info">
      <!-- å¦‚æœæœ‰å¤´åƒæ˜¾ç¤ºå¤´åƒï¼Œå¦åˆ™æ˜¾ç¤ºé»˜è®¤å¤´åƒ -->
      <view class="avatar" wx:if="{{!hasUserInfo}}" bindtap="getUserProfile">
        <text class="avatar-text">ç‚¹å‡»</text>
      </view>
      <view class="avatar" wx:else>
        <image wx:if="{{userInfo.avatarUrl}}" src="{{userInfo.avatarUrl}}" mode="aspectFill"></image>
        <text wx:else class="avatar-text">{{userInfo.nickName ? userInfo.nickName.substring(0,1) : 'ä¸»'}}</text>
      </view>
      <view class="user-details">
        <!-- å¦‚æœæ²¡æœ‰ç”¨æˆ·ä¿¡æ¯ï¼Œæ˜¾ç¤ºè·å–æŒ‰é’® -->
        <view class="user-name" wx:if="{{!hasUserInfo}}" bindtap="getUserProfile">ç‚¹å‡»è·å–å¾®ä¿¡ä¿¡æ¯</view>
        <view class="user-name" wx:else>{{userInfo.nickName || 'å® ç‰©ä¸»äºº'}}</view>
        <view class="user-phone">{{ownerInfo.phone || 'æœªè®¾ç½®æ‰‹æœºå·'}}</view>
      </view>
    </view>
    <view class="logout-btn" bindtap="logout">é€€å‡ºç™»å½•</view>
  </view>
  
  <!-- æ ‡é¢˜åŒºåŸŸ -->
  <view class="title-section">
    <text class="page-title">æˆ‘çš„å® ç‰©</text>
  </view>
  
  <!-- åŠ è½½ä¸­ -->
  <view class="loading-container" wx:if="{{loading}}">
    <view class="loading-spinner"></view>
    <view class="loading-text">åŠ è½½ä¸­...</view>
  </view>
  
  <!-- å® ç‰©è®°å½•åˆ—è¡¨ -->
  <view class="pet-list" wx:if="{{!loading && petRecords.length > 0}}">
    <view 
      class="pet-card" 
      wx:for="{{petRecords}}" 
      wx:key="_id"
      bindtap="viewPetDetail"
      data-id="{{item._id}}"
    >
      <view class="pet-card-left">
        <image 
          class="pet-avatar" 
          src="{{item.petInfo.avatar}}" 
          mode="aspectFill"
          wx:if="{{item.petInfo.avatar}}"
        ></image>
        <view class="default-avatar" wx:else>
          <text class="default-avatar-text">ğŸ¾</text>
        </view>
      </view>
      
      <view class="pet-card-content">
        <view class="pet-name-row">
          <text class="pet-name">{{item.petInfo.name}}</text>
          <view class="pet-status {{item.status === 'ä½é™¢' ? 'status-hospitalized' : 'status-postop'}}">
            {{item.status || 'æœ¯å'}}
          </view>
        </view>
        
        <view class="pet-info-row">
          <text class="pet-breed" wx:if="{{item.petInfo.breed}}">{{item.petInfo.breed}}</text>
          <text class="pet-reason" wx:if="{{item.reason}}">{{item.reason}}</text>
        </view>
        
        <view class="pet-hospital-row">
          <view class="pet-clinic" wx:if="{{item.clinicName}}">
            <text class="clinic-icon">ğŸ¥</text>
            <text class="clinic-name">{{item.clinicName}}</text>
          </view>
        </view>
        
        <view class="pet-update" wx:if="{{item.updates && item.updates.length > 0}}">
          <view class="update-row">
            <text class="update-icon">ğŸ“</text>
            <text class="update-text">æœ€æ–°æ›´æ–°: {{item.updateTimeAgo}}</text>
          </view>
          <view class="update-time">
            {{item.updateTimeFormatted}}
          </view>
        </view>
      </view>
      
      <view class="pet-card-right">
        <view class="arrow-right">â€º</view>
      </view>
    </view>
  </view>
  
  <!-- ç©ºçŠ¶æ€ -->
  <view class="empty-state" wx:if="{{!loading && emptyState}}">
    <view class="empty-icon">ğŸ¾</view>
    <view class="empty-text">æš‚æ— å® ç‰©è®°å½•</view>
    <view class="empty-subtext">å½“åŒ»é™¢ä¸ºæ‚¨çš„å® ç‰©åˆ›å»ºè®°å½•åï¼Œå°†ä¼šæ˜¾ç¤ºåœ¨è¿™é‡Œ</view>
  </view>
</view>
